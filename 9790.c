static bitcount_t smax(bitcount_t a, bitcount_t b) {
    return (a > b ? a : b);
}